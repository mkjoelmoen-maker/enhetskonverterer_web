<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üåç Enhets- og valutakonverterer</title>
    <!-- iOS webapp-ikon og oppf√∏rsel -->
    <!-- iOS webapp-ikon og oppf√∏rsel -->
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='icon_v2.png') }}">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
  <style>
    :root {
      --accent: #9C35FF;
      --bg-light: #f4f0ff;
      --text-light: #1e1e2f;
      --bg-dark: #101327;
      --text-dark: #f4f4f8;
      --glass-light: rgba(255, 255, 255, 0.65);
      --glass-dark: rgba(30, 30, 50, 0.45);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-light);
      color: var(--text-light);
      margin: 0;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: background 0.3s, color 0.3s;
      min-height: 100vh;
    }

    [data-theme="dark"] {
      background: var(--bg-dark);
      color: var(--text-dark);
    }

    h1 {
      text-align: center;
      color: var(--accent);
      font-weight: 700;
      font-size: 1.8rem;
      margin-bottom: 1rem;
    }

    .theme-toggle {
      position: absolute;
      top: 1rem;
      right: 1rem;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 30px;
    }

    .switch input { display: none; }

    .slider {
      position: absolute;
      cursor: pointer;
      inset: 0;
      background-color: #ccc;
      border-radius: 30px;
      transition: 0.4s;
    }

    .slider:before {
      content: "üåû";
      position: absolute;
      height: 24px;
      width: 24px;
      left: 3px;
      bottom: 3px;
      transition: 0.4s;
      text-align: center;
    }

    input:checked + .slider {
      background-color: var(--accent);
    }

    input:checked + .slider:before {
      transform: translateX(30px);
      content: "üåô";
    }

    form {
      width: 100%;
      max-width: 500px;
      background: var(--glass-light);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 16px;
      box-shadow: 0 4px 30px rgba(156, 53, 255, 0.15);
      padding: 2rem;
      transition: background 0.4s, box-shadow 0.4s;
    }

    [data-theme="dark"] form {
      background: var(--glass-dark);
      box-shadow: 0 4px 25px rgba(156, 53, 255, 0.25);
    }

    label {
      display: block;
      margin-top: 1rem;
      font-weight: 600;
    }

    select, input {
      width: 100%;
      padding: 0.6rem;
      margin-top: 0.3rem;
      border-radius: 8px;
      border: 1px solid rgba(156, 53, 255, 0.2);
      font-size: 1rem;
      background: rgba(255, 255, 255, 0.8);
      color: inherit;
      outline: none;
      transition: all 0.2s ease-in-out;
    }

    select:focus, input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 8px rgba(156, 53, 255, 0.3);
    }

    [data-theme="dark"] select, [data-theme="dark"] input {
      background: rgba(30, 30, 50, 0.6);
      border-color: rgba(156, 53, 255, 0.3);
    }

    button {
      display: block;
      width: 100%;
      margin-top: 1.5rem;
      background: var(--accent);
      color: white;
      border: none;
      padding: 0.8rem;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 0 12px rgba(156, 53, 255, 0.4);
      transition: transform 0.15s ease, box-shadow 0.2s ease;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 18px rgba(156, 53, 255, 0.6);
    }

    .result {
      margin-top: 2rem;
      width: 100%;
      max-width: 500px;
      background: var(--glass-light);
      backdrop-filter: blur(10px);
      padding: 1rem 1.5rem;
      border-left: 4px solid var(--accent);
      border-radius: 12px;
      font-size: 1.1rem;
      box-shadow: 0 2px 12px rgba(156, 53, 255, 0.1);
      transition: background 0.4s;
    }

    [data-theme="dark"] .result {
      background: var(--glass-dark);
    }

    .error {
      background: rgba(255, 100, 100, 0.15) !important;
      border-left-color: #ff5555;
    }
  </style>
</head>

<body>
  <div class="theme-toggle">
    <label class="switch">
      <input type="checkbox" id="themeSwitch">
      <span class="slider"></span>
    </label>
  </div>

  <h1>üåç Enhets- og valutakonverterer</h1>

  <form method="post">
    <label for="category">Kategori:</label>
    <select name="category" id="category" onchange="updateUnits()" data-units='{{ units | tojson }}'>
      {% for cat in units %}
        <option value="{{ cat }}" {% if cat == selected_category %}selected{% endif %}>
          {% if cat == "Lengde" %}üìè{% elif cat == "Vekt" %}‚öñÔ∏è{% elif cat == "Volum" %}üß™{% elif cat == "Tid" %}‚è∞{% elif cat == "Temperatur" %}üå°Ô∏è{% elif cat == "Valuta" %}üí∞{% endif %}
          {{ cat }}
        </option>
      {% endfor %}
    </select>

    <label for="from_unit">Fra:</label>
    <select name="from_unit" id="from_unit">
      {% for u in units[selected_category] %}
        <option value="{{ u }}" {% if u == from_unit %}selected{% endif %}>{{ u }}</option>
      {% endfor %}
    </select>

    <label for="to_unit">Til:</label>
    <select name="to_unit" id="to_unit">
      {% for u in units[selected_category] %}
        <option value="{{ u }}" {% if u == to_unit %}selected{% endif %}>{{ u }}</option>
      {% endfor %}
    </select>

    <label for="value">Verdi:</label>
    <input type="number" step="any" name="value" id="value" value="{{ value }}" required>

    <button type="submit">‚ú® Konverter</button>
  </form>

  {% if result %}
    <div class="result {% if '‚ö†Ô∏è' in result %}error{% endif %}">
      <strong>Resultat:</strong> {{ result }}
    </div>
  {% endif %}

  <script>
    const categorySelect = document.getElementById("category");
    const units = JSON.parse(categorySelect.dataset.units);

    function updateUnits() {
      const category = categorySelect.value;
      const fromSelect = document.getElementById("from_unit");
      const toSelect = document.getElementById("to_unit");

      const prevFrom = fromSelect.value;
      const prevTo = toSelect.value;

      fromSelect.innerHTML = "";
      toSelect.innerHTML = "";

      units[category].forEach(u => {
        const opt1 = document.createElement("option");
        opt1.value = u;
        opt1.text = u;
        if (u === prevFrom) opt1.selected = true;
        fromSelect.add(opt1);

        const opt2 = document.createElement("option");
        opt2.value = u;
        opt2.text = u;
        if (u === prevTo) opt2.selected = true;
        toSelect.add(opt2);
      });
    }

    // Dark/light mode toggle
    const themeSwitch = document.getElementById("themeSwitch");
    const body = document.body;

    if (localStorage.getItem("theme") === "dark") {
      body.dataset.theme = "dark";
      themeSwitch.checked = true;
    }

    themeSwitch.addEventListener("change", () => {
      if (themeSwitch.checked) {
        body.dataset.theme = "dark";
        localStorage.setItem("theme", "dark");
      } else {
        body.dataset.theme = "light";
        localStorage.setItem("theme", "light");
      }
    });
  </script>
</body>
</html>
